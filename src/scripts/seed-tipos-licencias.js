const { AppDataSource } = require('../config/database');
const TipoLicencia = require('../models/tipo-licencia.model');

async function seedTiposLicencias() {
  await AppDataSource.initialize();
  const repo = AppDataSource.getRepository('TipoLicencia');

  const tipos = [
    {
      codigo: 'PER-GOCE',
      nombre: 'Permiso personal con goce de salario',
      descripcion: 'Hasta 5 días anuales. A discreción de la jefatura, siempre que el servicio no quede descubierto. Puede ser media jornada o jornada completa.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 5,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'PER-SIN-GOCE',
      nombre: 'Permiso personal sin goce de salario',
      descripcion: 'Hasta 60 días anuales. A discreción de la jefatura, siempre que el servicio no quede descubierto. Solicitar con anticipación.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 60,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: false,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'ENFERMEDAD',
      nombre: 'Licencia por enfermedad (certificación médica)',
      descripcion: 'De 1 a 3 días con goce, del 4to en adelante sin goce. Requiere certificación médica del ISSS.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 365,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'ENF-GRAVE-PAR',
      nombre: 'Licencia por enfermedad gravísima de pariente',
      descripcion: 'Hasta 17 días anuales. Solo para parientes en primer grado de afinidad. Requiere certificación médica y documento de parentesco.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 17,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'DUELO',
      nombre: 'Licencia por duelo',
      descripcion: '3 días por fallecimiento de pariente en primer grado de afinidad. Requiere partida de defunción y documento de parentesco.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 3,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'MATERNIDAD',
      nombre: 'Licencia por maternidad',
      descripcion: '112 días por parto. Puede ser 30 días antes y 82 después, o 112 días desde el parto. Requiere certificación médica.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 112,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: true,
      genero_aplicable: 'F',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'LACTANCIA',
      nombre: 'Licencia por lactancia materna',
      descripcion: '6 meses a partir del nacimiento. 1 hora diaria (puede fraccionarse). Requiere carta solicitud y partida de nacimiento.',
      tipo_duracion: 'HORAS',
      duracion_maxima: 180,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: true,
      genero_aplicable: 'F',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'PATERNIDAD',
      nombre: 'Licencia por paternidad, nacimiento o adopción',
      descripcion: '3 días por nacimiento o adopción. Requiere partida de nacimiento o sentencia de adopción.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 3,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: true,
      genero_aplicable: 'M',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'MATRIMONIO',
      nombre: 'Permiso por matrimonio',
      descripcion: '3 días. Requiere certificación de matrimonio o partida de nacimiento con marginación.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 3,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'VACACIONES',
      nombre: 'Licencia por vacaciones anuales',
      descripcion: '15 días para personal operativo. Personal administrativo en dos periodos. Requiere control de licencia.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 15,
      requiere_justificacion: false,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: true,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: true,
      antiguedad_minima: 365,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'JRV',
      nombre: 'Permiso por cargo en juntas receptoras de votos',
      descripcion: 'El tiempo que solicite el organismo electoral. Requiere certificación del Tribunal Supremo Electoral.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 30,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'JURADO',
      nombre: 'Permiso por ser llamado a conformar jurado',
      descripcion: 'El tiempo que dure la audiencia. Requiere citación del juzgado y constancia de permanencia.',
      tipo_duracion: 'HORAS',
      duracion_maxima: 10,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'OLVIDO-ENTRADA',
      nombre: 'Olvido de marcación de entrada',
      descripcion: 'Hasta 2 olvidos al mes. Registrar fecha del suceso, fecha de solicitud y fecha de aprobación.',
      tipo_duracion: 'CANTIDAD',
      duracion_maxima: 2,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'OLVIDO-SALIDA',
      nombre: 'Olvido de marcación de salida',
      descripcion: 'Hasta 2 olvidos al mes. Registrar fecha del suceso, fecha de solicitud y fecha de aprobación.',
      tipo_duracion: 'CANTIDAD',
      duracion_maxima: 2,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'CAMBIO-TURNO',
      nombre: 'Cambio de turno',
      descripcion: 'Hasta 3 cambios de turno al mes. Requiere autorización de la jefatura.',
      tipo_duracion: 'CANTIDAD',
      duracion_maxima: 3,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    },
    {
      codigo: 'MOV-PLAN-TRABAJO',
      nombre: 'Movimiento de recurso humano en plan de trabajo mensual',
      descripcion: 'Según necesidad del servicio. Requiere justificación y comunicación a Talento Humano.',
      tipo_duracion: 'DIAS',
      duracion_maxima: 30,
      requiere_justificacion: true,
      requiere_aprobacion_especial: false,
      requiere_documentacion: true,
      pago_haberes: true,
      acumulable: false,
      transferible: false,
      aplica_genero: false,
      genero_aplicable: 'A',
      aplica_antiguedad: false,
      aplica_edad: false,
      aplica_departamento: false,
      aplica_cargo: false,
      aplica_tipo_personal: false,
      activo: true
    }
  ];

  for (const tipo of tipos) {
    const exists = await repo.findOneBy({ codigo: tipo.codigo });
    if (!exists) {
      await repo.save(tipo);
      console.log(`Insertado: ${tipo.nombre}`);
    } else {
      console.log(`Ya existe: ${tipo.nombre}`);
    }
  }
  await AppDataSource.destroy();
  console.log('Seed finalizado.');
}

seedTiposLicencias().catch(console.error); 